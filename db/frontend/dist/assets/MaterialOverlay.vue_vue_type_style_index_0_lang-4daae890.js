import{S as x,B as w,Z as O,L as C,i as m,N as M,O as S,w as _,P as T,t as B,Q as E,a as d,$ as A,T as k,d as q,h as p,o as g,c as b,f as D}from"./index-2991d910.js";import{a as K}from"./intl-701a3446.js";class U extends x{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.client.defaultMutationOptions(t),w(e,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){if(!this.listeners.length){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const e={listeners:!0};t.type==="success"?e.onSuccess=!0:t.type==="error"&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:O(),e={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){C.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var e,n,i,s;(e=(n=this.mutateOptions).onSuccess)==null||e.call(n,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(i=(s=this.mutateOptions).onSettled)==null||i.call(s,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var u,c,a,o;(u=(c=this.mutateOptions).onError)==null||u.call(c,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(a=(o=this.mutateOptions).onSettled)==null||a.call(o,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(v=>{v(this.currentResult)})})}}function Y(l,t,e){var n;const i=m(()=>L(l,t,e)),s=(n=i.value.queryClient)!=null?n:K(i.value.queryClientKey),u=new U(s,s.defaultMutationOptions(i.value)),c=M(u.getCurrentResult()),a=u.subscribe(h=>{S(c,h)}),o=(h,y)=>{u.mutate(h,y).catch(()=>{})};return _(i,()=>{u.setOptions(s.defaultMutationOptions(i.value))},{deep:!0}),T(()=>{a()}),{...B(E(c)),mutate:o,mutateAsync:c.mutate,reset:c.reset}}function L(l,t,e){const n=d(l),i=d(t);let s=n;return A(n)&&(typeof i=="function"?s={...d(e),mutationKey:n,mutationFn:i}:s={...i,mutationKey:n}),typeof n=="function"&&(s={...i,mutationFn:n}),k(s)}const F=["viewBox"],N=["data-touch-state","data-selected","cx","cy"],j=q({__name:"MaterialOverlay",props:{selectable:{type:Boolean}},emits:["click","select"],setup(l,{emit:t}){const e=l,n=p(),i=m(()=>{if(!n.value)return{width:0,height:0};const r=n.value.getBoundingClientRect();return{width:r.width,height:r.height}}),s=p("inactive"),u=p(0),c=250,a=p(!1),o=M({x:0,y:0});function v(r){if(r instanceof MouseEvent)o.x=r.offsetX,o.y=r.offsetY;else{const f=r.target.getBoundingClientRect();o.x=r.targetTouches[0].pageX-f.left,o.y=r.targetTouches[0].pageY-f.top}}function h(r){s.value="touchstart",u.value=Date.now(),v(r)}function y(r){s.value="touchend"}function R(r){if(s.value!=="touchend"){if(e.selectable&&(Date.now()-u.value>=c||a.value)){navigator.vibrate(50),a.value=!a.value,t("select",a.value),s.value="touchend";return}t("click"),s.value="touchend"}}return(r,f)=>(g(),b("div",{ref_key:"overlay",ref:n,class:"material-overlay",onTouchstart:h,onTouchend:R,onTouchmove:y},[(g(),b("svg",{viewBox:`0 0 ${d(i).width} ${d(i).height}`,xmlns:"http://www.w3.org/2000/svg"},[D("circle",{"data-touch-state":s.value,"data-selected":a.value,cx:o.x,cy:o.y,r:"0"},null,8,N)],8,F))],544))}});export{j as _,Y as u};
