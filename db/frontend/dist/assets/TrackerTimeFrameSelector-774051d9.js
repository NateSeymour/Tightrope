import{d as J,u as ce}from"./intl-701a3446.js";import{g as _e,h as de,i as y,j as le,d as P,s as N,k,t as fe,l as ve,w as A,m as Q,n as he,p as pe,q as ge,v as ze,x as be,y as me,a as d,z as ye,e as we,o as ee,c as xe,f as B,A as R,_ as Oe}from"./index-2991d910.js";var w=(e=>(e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Month=2592e6]="Month",e[e.Year=31536e6]="Year",e))(w||{});const te=_e("time",()=>{const e=de(2592e6),t=y(()=>{const r=Date.now(),i=[];for(let n=r+864e5-e.value;n<=r;n+=864e5){const s=J.format(n);i.push(s)}return i});return le(()=>{window.innerWidth<500?e.value=6048e5:e.value=2592e6}),{displayTimeFrame:e,timeFrameDateLabels:t}});var U=null;function Ee(e){return U||(U=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),U(e)}var q=null;function Ce(e){q||(q=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),q(e)}function Se(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function D(e,t){t===void 0&&(t={});var r=document.createElement(e);return Object.keys(t).forEach(function(i){r[i]=t[i]}),r}function re(e,t,r){var i=window.getComputedStyle(e,r||null)||{display:"none"};return i[t]}function $(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(re(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var Le='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',I=0,W=null;function Me(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=De.bind(e));var r=e.__resize_listeners__;if(!r){if(e.__resize_listeners__=[],window.ResizeObserver){var i=e.offsetWidth,n=e.offsetHeight,s=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===i&&e.offsetHeight===n)||j(e)}),u=$(e),v=u.detached,h=u.rendered;e.__resize_observer_triggered__=v===!1&&h===!1,e.__resize_observer__=s,s.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){j(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(I||(W=Se(Le)),Te(e),e.__resize_rendered__=$(e).rendered,window.MutationObserver){var l=new MutationObserver(e.__resize_mutation_handler__);l.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=l}}e.__resize_listeners__.push(t),I++}function ke(e,t){var r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",Y),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--I&&W&&W.parentNode.removeChild(W)}}function Ae(e){var t=e.__resize_last__,r=t.width,i=t.height,n=e.offsetWidth,s=e.offsetHeight;return n!==r||s!==i?{width:n,height:s}:null}function De(){var e=$(this),t=e.rendered,r=e.detached;t!==this.__resize_rendered__&&(!r&&this.__resize_triggers__&&(V(this),this.addEventListener("scroll",Y,!0)),this.__resize_rendered__=t,j(this))}function Y(){var e=this;V(this),this.__resize_raf__&&Ce(this.__resize_raf__),this.__resize_raf__=Ee(function(){var t=Ae(e);t&&(e.__resize_last__=t,j(e))})}function j(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function Te(e){var t=re(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var r=D("div",{className:"resize-triggers"}),i=D("div",{className:"resize-expand-trigger"}),n=D("div"),s=D("div",{className:"resize-contract-trigger"});i.appendChild(n),r.appendChild(i),r.appendChild(s),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:i,expandChild:n,contract:s},V(e),e.addEventListener("scroll",Y,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function V(e){var t=e.__resize_triggers__,r=t.expand,i=t.expandChild,n=t.contract,s=n.scrollWidth,u=n.scrollHeight,v=r.offsetWidth,h=r.offsetHeight,l=r.scrollWidth,p=r.scrollHeight;n.scrollLeft=s,n.scrollTop=u,i.style.width=v+1+"px",i.style.height=h+1+"px",r.scrollLeft=l,r.scrollTop=p}var b=function(){return b=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},b.apply(this,arguments)},We=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function je(e){return t=Object.create(null),We.forEach(function(r){t[r]=function(i){return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[i].apply(e.value,n)}}(r)}),t;var t}var He={autoresize:Boolean},Fe=/^on[^a-z]/,Ne=function(e){return Fe.test(e)};function T(e,t){var r=d(e);return r&&typeof r=="object"&&"value"in r?r.value||t:r||t}var Be={loading:Boolean,loadingOptions:Object},x=null,X=[],O=[];(function(e,t){if(e&&typeof document<"u"){var r,i=t.prepend===!0?"prepend":"append",n=t.singleTag===!0,s=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(n){var u=X.indexOf(s);u===-1&&(u=X.push(s)-1,O[u]={}),r=O[u]&&O[u][i]?O[u][i]:O[u][i]=v()}else r=v();e.charCodeAt(0)===65279&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function v(){var h=document.createElement("style");if(h.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),p=0;p<l.length;p++)h.setAttribute(l[p],t.attributes[l[p]]);var H=i==="prepend"?"afterbegin":"beforeend";return s.insertAdjacentElement(H,h),h}})(`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`,{});var Re=function(){if(x!=null)return x;if(typeof HTMLElement>"u"||typeof customElements>"u")return x=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)("x-vue-echarts")}catch{return x=!1}return x=!0}(),Ue=P({name:"echarts",props:b(b({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},He),Be),emits:{},inheritAttrs:!1,setup:function(e,t){var r=t.attrs,i=N(),n=N(),s=N(),u=k("ecTheme",null),v=k("ecInitOptions",null),h=k("ecUpdateOptions",null),l=fe(e),p=l.autoresize,H=l.manualUpdate,ne=l.loading,ie=l.loadingOptions,se=y(function(){return s.value||e.option||null}),Z=y(function(){return e.theme||T(u,{})}),G=y(function(){return e.initOptions||T(v,{})}),K=y(function(){return e.updateOptions||T(h,{})}),ae=y(function(){return function(f){var a={};for(var _ in f)Ne(_)||(a[_]=f[_]);return a}(r)}),oe=ve().proxy.$listeners;function E(f){if(i.value){var a=n.value=ze(i.value,Z.value,G.value);e.group&&(a.group=e.group);var _=oe;_||(_={},Object.keys(r).filter(function(c){return c.indexOf("on")===0&&c.length>2}).forEach(function(c){var o=c.charAt(2).toLowerCase()+c.slice(3);o.substring(o.length-4)==="Once"&&(o="~".concat(o.substring(0,o.length-4))),_[o]=r[c]})),Object.keys(_).forEach(function(c){var o=_[c];if(o){var g=c.toLowerCase();g.charAt(0)==="~"&&(g=g.substring(1),o.__once__=!0);var m=a;if(g.indexOf("zr:")===0&&(m=a.getZr(),g=g.substring(3)),o.__once__){delete o.__once__;var S=o;o=function(){for(var L=[],M=0;M<arguments.length;M++)L[M]=arguments[M];S.apply(void 0,L),m.off(g,o)}}m.on(g,o)}}),p.value?be(function(){a&&!a.isDisposed()&&a.resize(),z()}):z()}function z(){var c=f||se.value;c&&a.setOption(c,K.value)}}function F(){n.value&&(n.value.dispose(),n.value=void 0)}var C=null;A(H,function(f){typeof C=="function"&&(C(),C=null),f||(C=A(function(){return e.option},function(a,_){a&&(n.value?n.value.setOption(a,b({notMerge:a!==_},K.value)):E())},{deep:!0}))},{immediate:!0}),A([Z,G],function(){F(),E()},{deep:!0}),Q(function(){e.group&&n.value&&(n.value.group=e.group)});var ue=je(n);return function(f,a,_){var z=k("ecLoadingOptions",{}),c=y(function(){return b(b({},T(z,{})),_==null?void 0:_.value)});Q(function(){var o=f.value;o&&(a.value?o.showLoading(c.value):o.hideLoading())})}(n,ne,ie),function(f,a,_){var z=null;A([_,f,a],function(c,o,g){var m=c[0],S=c[1],L=c[2];m&&S&&L&&(z=me(function(){S.resize()},100),Me(m,z)),g(function(){z&&m&&ke(m,z)})})}(n,p,i),he(function(){E()}),pe(function(){Re&&i.value?i.value.__dispose=F:F()}),b({chart:n,root:i,setOption:function(f,a){e.manualUpdate&&(s.value=f),n.value?n.value.setOption(f,a||{}):E(f)},nonEventAttrs:ae},ue)},render:function(){var e=b({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",ge("x-vue-echarts",e)}});const Ye=P({__name:"MetricGraph",props:{metric:null},setup(e){const t=e,r=te(),{data:i}=ce({queryKey:["metric",t.metric.name,"measurements"],queryFn:t.metric.fetchMeasurements}),n=t.metric.useLocalizedUnit(),s=y(()=>{const u=new Array(r.timeFrameDateLabels.length);u.fill("-");for(const v of i.value||[]){const h=J.format(v.millis),l=v.value*n.conversion;u[r.timeFrameDateLabels.indexOf(h)]=l}return{title:{show:!0,text:t.metric.name},dataZoom:[{type:"inside",id:"insideX",xAxisIndex:0,zoomOnMouseWheel:!0,moveOnMouseMove:!0}],xAxis:{type:"category",data:r.timeFrameDateLabels,axisLabel:{rotate:45}},yAxis:{type:"value",name:n.short,scale:!0},tooltip:{formatter:`{c} ${n.short}`},series:[{data:u,type:"line",smooth:!0,connectNulls:!0,itemStyle:{color:"white",size:20,borderWidth:3,borderColor:"#ee6c4d"},lineStyle:{color:"#ee6c4d",width:4}}]}});return(u,v)=>d(i)?(ee(),ye(d(Ue),{key:0,class:"chart",option:d(s),autoresize:""},null,8,["option"])):we("",!0)}}),qe={class:"time-selector"},$e=P({__name:"TrackerTimeFrameSelector",setup(e){const t=te();return(r,i)=>(ee(),xe("div",qe,[B("button",{onClick:i[0]||(i[0]=n=>d(t).displayTimeFrame=d(w).Week),class:R(d(t).displayTimeFrame==d(w).Week?"selected":"")},"W",2),B("button",{onClick:i[1]||(i[1]=n=>d(t).displayTimeFrame=d(w).Month),class:R(d(t).displayTimeFrame==d(w).Month?"selected":"")},"M",2),B("button",{onClick:i[2]||(i[2]=n=>d(t).displayTimeFrame=d(w).Year),class:R(d(t).displayTimeFrame==d(w).Year?"selected":"")},"Y",2)]))}});const Ve=Oe($e,[["__scopeId","data-v-bb16d568"]]);export{Ve as T,Ye as _};
